<!doctype html>  
<!--[if IE 6 ]><html lang="en-us" class="ie6"> <![endif]-->
<!--[if IE 7 ]><html lang="en-us" class="ie7"> <![endif]-->
<!--[if IE 8 ]><html lang="en-us" class="ie8"> <![endif]-->
<!--[if (gt IE 7)|!(IE)]><!-->
<html lang="en-us"><!--<![endif]-->
<head>
	<meta charset="utf-8">
	
	<title>WordPress GCM Plugin</title>
	
	<meta name="description" content="GCM for WordPress with alot of features">
	<meta name="author" content="Deniz Celebi and Pixelart Web and App Development">
	<meta name="copyright" content="Deniz Celebi and Pixelart Web and App Development">
	<meta name="generator" content="Documenter v2.0 http://rxa.li/documenter">
	<meta name="date" content="2014-12-31T00:00:00+01:00">
	
	<link rel="stylesheet" href="assets/css/documenter_style.css" media="all">
	<link rel="stylesheet" href="assets/js/google-code-prettify/prettify.css" media="screen">
	<script src="assets/js/google-code-prettify/prettify.js"></script>

	
	
	<script src="assets/js/jquery.js"></script>
	
	<script src="assets/js/jquery.scrollTo.js"></script>
	<script src="assets/js/jquery.easing.js"></script>
	
	<script>document.createElement('section');var duration='500',easing='swing';</script>
	<script src="assets/js/script.js"></script>
	
	<style>
		html{background-color:#F1F1CA;color:#554236;}
		::-moz-selection{background:#45352C;color:#CDB380;}
		::selection{background:#45352C;color:#CDB380;}
		#documenter_sidebar #documenter_logo{background-image:url();}
		a{color:#F77825;}
		.btn {
			border-radius:3px;
		}
		.btn-primary {
			  background-image: -moz-linear-gradient(top, #F77825, #C7611E);
			  background-image: -ms-linear-gradient(top, #F77825, #C7611E);
			  background-image: -webkit-gradient(linear, 0 0, 0 F77825%, from(#554236), to(#C7611E));
			  background-image: -webkit-linear-gradient(top, #F77825, #C7611E);
			  background-image: -o-linear-gradient(top, #F77825, #C7611E);
			  background-image: linear-gradient(top, #F77825, #C7611E);
			  filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#F77825', endColorstr='#C7611E', GradientType=0);
			  border-color: #C7611E #C7611E #bfbfbf;
			  color:#FFFFFF;
		}
		.btn-primary:hover,
		.btn-primary:active,
		.btn-primary.active,
		.btn-primary.disabled,
		.btn-primary[disabled] {
		  border-color: #F77825 #F77825 #bfbfbf;
		  background-color: #C7611E;
		}
		hr{border-top:1px solid #DEDEBA;border-bottom:1px solid #FFFFD6;}
		#documenter_sidebar, #documenter_sidebar ul a{background-color:#554236;color:#CDB380;}
		#documenter_sidebar ul a{-webkit-text-shadow:1px 1px 0px #6B5344;-moz-text-shadow:1px 1px 0px #6B5344;text-shadow:1px 1px 0px #6B5344;}
		#documenter_sidebar ul{border-top:1px solid #30251F;}
		#documenter_sidebar ul a{border-top:1px solid #6B5344;border-bottom:1px solid #30251F;color:#F77825;}
		#documenter_sidebar ul a:hover{background:#45352C;color:#CDB380;border-top:1px solid #45352C;}
		#documenter_sidebar ul a.current{background:#45352C;color:#CDB380;border-top:1px solid #45352C;}
		#documenter_copyright{display:block !important;visibility:visible !important;}
	</style>
	
</head>
<body class="documenter-project-wordpress-gcm-plugin">
	<div id="documenter_sidebar">
		<a href="#documenter_cover" id="documenter_logo"></a>
		<ul id="documenter_nav">
			<li><a class="current" href="#documenter_cover">Start</a></li>
				
			<li><a href="#how_to_start" title="How To Start">How To Start</a></li>
			<li><a href="#the_message_types" title="The Message Types">The Message Types</a></li>
			<li><a href="#custom_message_type" title="Custom Message Type">Custom Message Type</a></li>
			<li><a href="#device_list" title="Device List">Device List</a></li>
			<li><a href="#stats" title="Stats">Stats</a></li>
			<li><a href="#export" title="Export">Export</a></li>
			<li><a href="#app_side" title="App side">App side</a></li>
			<li><a href="#info" title="Info">Info</a></li>

		</ul>
		<div id="documenter_copyright">Copyright Deniz Celebi and Pixelart Web and App Development 2014<br>
		made with the <a href="http://rxa.li/documenter">Documenter v2.0</a> 
		</div>
	</div>
	<div id="documenter_content">
	<section id="documenter_cover">
	<h1>WordPress GCM Plugin</h1>
	
	<div id="documenter_buttons">
		
	</div>
	<hr>
	<ul>
	<li>created: 12/17/2014</li>
	<li>latest update: 12/31/2014</li>
	<li>by: Deniz Celebi and Pixelart Web and App Development</li>
	<li><a href=""></a></li>
	<li>email: <a href="mailto:&#99;&#111;&#110;&#116;&#97;&#99;&#116;&#64;&#112;&#105;&#120;&#101;&#108;&#97;&#114;&#116;&#100;&#101;&#118;&#46;&#99;&#111;&#109;">&#99;&#111;&#110;&#116;&#97;&#99;&#116;&#64;&#112;&#105;&#120;&#101;&#108;&#97;&#114;&#116;&#100;&#101;&#118;&#46;&#99;&#111;&#109;</a></li>
	</ul>
	<p></p>
	</section>
	
	<section id="how_to_start">
	<div class="page-header"><h3>How To Start</h3><hr class="notop"></div>
<p>
	Before we can start, you need an API Key. If you already know, how to obtain one, jump to step 7, else follow these steps:</p>
<p>
	<strong>1</strong>. You need a Google Account. If you already have one, go to the Google Api Console, and login. Create a new Project if you haven&#39;t already.</p>
<p>
	<strong>2</strong>. Now select your Project and go to &quot;APIs &amp; auth&quot; &gt; &quot;APIs&quot; and activate &quot;Google Cloud Messaging for Android&quot;.<br>
	<img alt="" src="assets/img/screen-1.png"></p>
<p>
	<strong>3</strong>. No you need youir API Key. Tp get one navigate to &quot;APIs &amp;auth&quot; &gt; &quot;Credentials&quot;. Then click on &quot;Create new Key&quot;.<br>
	<img alt="" src="assets/img/screen-2.png"></p>
<p>
	<strong>4</strong>. Now this step is very important: Click on &quot;<strong>Browser</strong> <strong>key</strong>&quot;, not on &quot;Server key&quot; (but on some servers &quot;Server key&quot; is working).<br>
	<img alt="" src="assets/img/screen-3.png"></p>
<p>
	<strong>5</strong>. Just enter your Domain like below an press &quot;Create&quot;.<br>
	<img alt="" src="assets/img/screen-4.png"></p>
<p>
	<strong>6</strong>. Now you will see you Api Key. Copy the line &quot;API KEY&quot; highlited below. This is your API Key.<br>
	<img alt="" src="assets/img/screen-5.png"></p>
<p>
	<strong>7.</strong> Now open your WordPress Admin Backend, on go to &quot;GCM&quot; &gt; &quot;Settings&quot;. Enter in the Api Key Field your Api Key and press &quot;Save Changes&quot;.<br>
	<img alt="" src="assets/img/screen-6.png"></p>
<p>
	<strong>8</strong>. Your done!</p>
</section>
<section id="the_message_types">
	<div class="page-header"><h3>The Message Types</h3><hr class="notop"></div>
<p>
	Now the Plugin comes with 3 different Message Types out of the box.&nbsp;<br>
	The first one you already know, its the normal &quot;message&quot; one. The two others are &quot;new_post&quot; and &quot;update&quot;.</p>
<p>
	As GCM sends Messages in Json format it needs two attributes. The first Parameter ist the message type, the second one is the data.&nbsp;</p>
<p>
	We did it in a way thats is usefull for every need, so you need 2 parameters for sending a message or something like that.</p>
<ul>
	<li>
		The first one is always the &quot;type&quot; of the message. The plugin uses 3 types of messages; 1. the normal &quot;message&quot; which just sends a message, the second &quot;new_post&quot;, which notifys the app that a new post is released and the third &quot;update&quot; which lets the app know that a post is been updated.</li>
	<li>
		The second parameter is the &quot;data&quot; parameter. It contains what to send. Again the App has different data types: if the type is &quot;message&quot;, it will just send the message content as data. If type is &quot;new_post&quot; or &quot;update&quot;, it will send the post id, author, title and url.<br>
		&nbsp;</li>
</ul>
<p>
	So if a new post will be published, it automatically sends a GCM-Message containing the post title, url, id and author, if your activated it under the settings.</p>
<p>
	<img alt="" src="assets/img-screen-7.png"></p>
</section>
<section id="custom_message_type">
	<div class="page-header"><h3>Custom Message Type</h3><hr class="notop"></div>
<p>
	If you want to Create your custom message type and message, all you need is to add a function called what ever you want:</p>
<pre class="prettyprint lang-php linenums">
function xy() {
   $messageData = &quot;Hello wolrd!&quot;;
   $messageType = &quot;myType&quot;;
   
   px_sendGCM($messageType, $messageData);
}</pre>
<div>
	&nbsp;</div>
<div>
	This is all you need. Just Call px_sendGCM($param1, $param2);</div>
<div>
	As you have noticed px_sendGCM() is the main method. So what does it, what returns it?</div>
<div>
	&nbsp;</div>
<div>
	First the complete constructor is&nbsp;</div>
<pre>
px_sendGCM($messageType, $messageData, $ids)</pre>
<p>
	The first two are must and are needed to work. The third one is optional and is used e.g. if we send a single device message. In theory it could contain up to 999 single ids, but you shouldn&#39;t do that. If you want to send to all ids, just leave it blank, don&#39;t use the third parameter, the function will notice it and send it to all ids.</p>
<p>
	The function returns a html string, which could be outputted. The string is just the response, with how many succeded and how many failed to send and if debug is activated, if will output debug messages from Google.</p>
</section>
<section id="device_list">
	<div class="page-header"><h3>Device List</h3><hr class="notop"></div>
<p>
	The plugin provides a device list where you could see each device and its information. Here you have the possiblity to directly delete a device from the database, or sort the table or search for a tag. If you click on the gcm id, it opens a detail page with information about the registrated device and a stats of how many message were sent to this device. And of course you can send a single message to this device.</p>
</section>
<section id="stats">
	<div class="page-header"><h3>Stats</h3><hr class="notop"></div>
<p>
	As you may have noticed, the plugin has a stats page. This page shows you some statistics about the registrations your usage and more. It has 15 predefined colors for the charts (the third chart uses only green and red). If you have more than 15 entries in your chart, you just need to add a new entry in the <strong>$color1</strong> and <strong>$color2</strong> array with your color.</p>
<p>
	The arrays could be found in the stats.php on line 8 and 26. The array looks like this:</p>
<pre class="prettyprint lang-php linenums">
$color1 = array(
    16 =&gt; &#39;#1c99e1&#39;,
);</pre>
<p>
	If you want to add a new color, add a dark one to the array <strong>$color1</strong> and a light version of the same color to the array <strong>$color2</strong>.</p>
</section>
<section id="export">
	<div class="page-header"><h3>Export</h3><hr class="notop"></div>
<p>
	The plugin provides the option to export all the information to a excel readable file, with the whole information about every device (like registration date, id, stats, model, os, ...)</p>
</section>
<section id="app_side">
	<div class="page-header"><h3>App side</h3><hr class="notop"></div>
<p>
	Now lets come to the most important side: <strong>The Client side</strong></p>
<p>
	The plugin wouldn&#39;t be so usefull without an sample app, which shows how to implement everything. You can just copy the example classes from the sample and use them in your project. When an device registers its self, it also gives the information about its os and model. We strongly recommend of copying just the sample 3 classes, and then do your stuff in the 3 methods. In the MainActivity, you will see in the onCreate this:</p>
<p>
	&nbsp;</p>
<pre class="prettyprint lang-plain linenums">
</pre>
<div>
	// for each message type we define a method</div>
<div>
	String todo = getIntent().getStringExtra(&quot;todo&quot;); &nbsp; &nbsp;</div>
<div>
	if(todo.equals(&quot;newPost&quot;)) {</div>
<div>
	&nbsp; &nbsp;newPost();</div>
<div>
	}else if(todo.equals(&quot;updatePost&quot;)) {</div>
<div>
	&nbsp; &nbsp;updatePost();</div>
<div>
	}else if(todo.equals(&quot;message&quot;)) {</div>
<div>
	&nbsp; &nbsp;message();</div>
<div>
	}</div>
<p>
	As you will see for each message type we set the method which handles what to do. Now if you have your own, custom Message type, you need to set here what to do with it. But before we get here, you need to do some pre work: Open the GcmIntentService.java . There you should see this:</p>
<pre class="prettyprint lang-plain linenums">
</pre>
<div>
	if (!extras.isEmpty()) {</div>
<div>
	&nbsp; &nbsp; &nbsp;if (GoogleCloudMessaging.MESSAGE_TYPE_MESSAGE.equals(messageType)) {</div>
<div>
	&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Apple-tab-span"> </span>if(extras.getString(&quot;message&quot;) != null){</div>
<div>
	&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Apple-tab-span"> </span>sendMessageNotification(extras.getString(&quot;message&quot;));</div>
<div>
	&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Apple-tab-span"> </span>}else if(extras.getString(&quot;update&quot;) != null) {</div>
<div>
	&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Apple-tab-span"> </span>sendUpdateNotification(extras.getString(&quot;update&quot;));</div>
<div>
	&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Apple-tab-span"> </span>}else if(extras.getString(&quot;new_post&quot;) != null) {</div>
<div>
	&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Apple-tab-span"> </span>sendNewNotification(extras.getString(&quot;new_post&quot;));</div>
<div>
	&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Apple-tab-span"> </span>}</div>
<div>
	&nbsp; &nbsp; &nbsp; }</div>
<div>
	}</div>
<p>
	Here we define a method which does what we want with the message directly from GCM. We define a method and set its parameter the content of the message. The method does the work, like cutting out information of the message and gives it &nbsp;to the previously showen MainActivity. A method would look like this (e.g. for New Post Notification):</p>
<pre class="prettyprint lang-plain linenums">
</pre>
<div>
	private void sendNewNotification(String post) {</div>
<div>
	&nbsp; &nbsp; <span class="Apple-tab-span"> </span>String p = post;</div>
<div>
	&nbsp; &nbsp; <span class="Apple-tab-span"> </span>String[] ps = p.split(&quot;;&quot;);</div>
<div>
	&nbsp; &nbsp; <span class="Apple-tab-span"> </span>String title = ps[0];</div>
<div>
	&nbsp; &nbsp; <span class="Apple-tab-span"> </span>String url = ps[1];</div>
<div>
	&nbsp; &nbsp; <span class="Apple-tab-span"> </span>String id = ps[2];</div>
<div>
	&nbsp; &nbsp; <span class="Apple-tab-span"> </span>String author = ps[3];</div>
<div>
	&nbsp; &nbsp; <span class="Apple-tab-span"> </span></div>
<div>
	&nbsp; &nbsp; &nbsp; &nbsp; Intent intent = new Intent(GcmIntentService.this, MainActivity.class);</div>
<div>
	&nbsp; &nbsp; &nbsp; &nbsp; intent.putExtra(&quot;todo&quot;,&quot;updatePost&quot;);</div>
<div>
	&nbsp;<span class="Apple-tab-span"> </span>intent.putExtra(&quot;post_title&quot;, title);</div>
<div>
	&nbsp;<span class="Apple-tab-span"> </span>intent.putExtra(&quot;post_url&quot;, url);</div>
<div>
	&nbsp;<span class="Apple-tab-span"> </span>intent.putExtra(&quot;post_id&quot;, id);</div>
<div>
	&nbsp;<span class="Apple-tab-span"> </span>intent.putExtra(&quot;post_author&quot;, author);</div>
<div>
	&nbsp; &nbsp; &nbsp; &nbsp; PendingIntent contentIntent = PendingIntent.getActivity(this, 0,intent, PendingIntent.FLAG_CANCEL_CURRENT);</div>
<div>
	&nbsp;</div>
<div>
	&nbsp; &nbsp; &nbsp; &nbsp; SharedPreferences prefs = PreferenceManager.getDefaultSharedPreferences(this);</div>
<div>
	&nbsp; &nbsp; &nbsp; &nbsp; boolean notificate = prefs.getBoolean(&quot;notifications&quot;, true);</div>
<div>
	&nbsp; &nbsp; &nbsp; &nbsp; boolean vibrate = prefs.getBoolean(&quot;notifications_vibrate&quot;, true);</div>
<div>
	&nbsp; &nbsp; &nbsp; &nbsp; Uri uri = Uri.parse(prefs.getString(&quot;notifications_ringtone&quot;, &quot;none&quot;));</div>
<div>
	&nbsp;<span class="Apple-tab-span"> </span>Bitmap bm = BitmapFactory.decodeResource(getResources(), R.drawable.ic_launcher);</div>
<div>
	&nbsp;<span class="Apple-tab-span"> </span></div>
<div>
	&nbsp;<span class="Apple-tab-span"> </span>mNotificationManager = (NotificationManager) getSystemService(Context.NOTIFICATION_SERVICE);</div>
<div>
	&nbsp;<span class="Apple-tab-span"> </span>NotificationCompat.Builder mBuilder = new NotificationCompat.Builder(</div>
<div>
	this)</div>
<div>
	.setLargeIcon(bm)</div>
<div>
	.setSmallIcon(R.drawable.ic_launcher)</div>
<div>
	.setSound(uri)</div>
<div>
	.setAutoCancel(true)</div>
<div>
	.setStyle(new NotificationCompat.BigTextStyle().bigText(Html.fromHtml(&quot;New Post released &lt;b&gt;&quot;+title+&quot;&lt;/b&gt;&quot;)))</div>
<div>
	.setContentText(Html.fromHtml(&quot;New Post released &lt;b&gt;&quot;+title+&quot;&lt;/b&gt;&quot;))</div>
<div>
	.setContentTitle(getString(R.string.app_name))</div>
<div>
	.setContentIntent(contentIntent);</div>
<div>
	&nbsp;<span class="Apple-tab-span"> </span></div>
<div>
	&nbsp; &nbsp; &nbsp; &nbsp; if (vibrate &amp;&amp; notificate) {</div>
<div>
	&nbsp; &nbsp; &nbsp; &nbsp; <span class="Apple-tab-span"> </span>mBuilder.setDefaults(Notification.DEFAULT_LIGHTS| Notification.DEFAULT_VIBRATE);</div>
<div>
	&nbsp; &nbsp; &nbsp; &nbsp; <span class="Apple-tab-span"> </span>mNotificationManager.notify(0, mBuilder.build());</div>
<div>
	&nbsp;<span class="Apple-tab-span"> </span>}else if(!vibrate &amp;&amp; notificate){</div>
<div>
	&nbsp;<span class="Apple-tab-span"> </span>mBuilder.setDefaults(Notification.DEFAULT_LIGHTS);</div>
<div>
	&nbsp;<span class="Apple-tab-span"> </span>mNotificationManager.notify(0, mBuilder.build());</div>
<div>
	&nbsp;<span class="Apple-tab-span"> </span>}</div>
<div>
	&nbsp; &nbsp; }</div>
<p>
	It looks complicated, yes, but actually it isn&#39;t. The most important part is first the strings at the top and the intents. The rest is nearly the same for every method: It set the settings for the notification in the statusbar, gets sound settings and so on. Just one thing changes in every method: The text which will be showen in the Statusbar. So if you won&#39;t show anything in the Statusbar (e.g. the message is only for the app to delete something or set a setting), then just delete the whole notification part after the intents.</p>
<p>
	So now lets get back to the MainActivity. We know now how the retrieve the message and how to handle it. But now comes another big topic: How to register? Is actually quite easy, you just need to copy the whole part which is commented with &quot;<strong>GCM Registration Part - REGISTRATION TO YOUR WEBSITE</strong>&quot; to your code and call the functions. If you read through the code you will find everything you need!</p>
<p>
	&nbsp;</p>
<p>
	<strong>Now lets go and build some awesome things with it! </strong></p>
<p>
	<em>And don&#39;t forget to rate ;-)</em></p>
</section>
<section id="info">
	<div class="page-header"><h3>Info</h3><hr class="notop"></div>
<p>
	Plugin Homepage:&nbsp;<a href="http://pixelartdev.com/referenz/wp-google-cloud-messaging-plugin">http://pixelartdev.com/referenz/wp-google-cloud-messaging-plugin</a>&nbsp;(German)</p>
<h3>
	<strong>Please Rate on CodeCanyon!</strong></h3>
</section>

	</div>
</body>
</html>